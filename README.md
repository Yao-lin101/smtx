# SMTX - 语言学习模板应用

SMTX 是一个专为语言学习者设计的 iOS 应用，帮助用户创建、管理和练习语言学习模板。

## 功能特点

### 模板管理
- 按语言分类管理模板
- 支持列表和画廊两种显示模式
- 可自定义模板封面、标题和标签
- 提供编辑和删除功能

### 时间轴编辑
- 创建带有时间点的学习内容
- 支持文字脚本和图片内容
- 灵活的时长设置
- 实时预览时间轴

### 录音练习
- 根据模板内容进行录音练习
- 实时显示录音时间
- 保存录音记录
- 回放录音内容

### 用户界面
- 现代化的界面设计
- 支持深色/浅色模式
- 流畅的动画效果
- 直观的操作体验

## 技术特点

- 基于 SwiftUI 构建的原生 iOS 应用
- 采用 MVVM 架构设计
- 使用 AVFoundation 处理音频
- 本地数据持久化存储
- 响应式界面设计

## 系统要求

- iOS 16.0 或更高版本
- Xcode 15.0 或更高版本（用于开发）

## 开发说明

### 项目结构
```
smtx/
├── Views/              # 视图相关文件
├── Models/             # 数据模型
├── Utilities/          # 工具类
└── Resources/          # 资源文件
```

### 主要组件
- `LanguageSectionView`: 语言分区视图
- `CreateTemplateView`: 模板创建/编辑视图
- `TimelineEditorView`: 时间轴编辑视图
- `RecordingView`: 录音练习视图
- `TemplateDetailView`: 模板详情视图

### 数据管理
- 使用 `TemplateStorage` 管理模板数据
- 支持模板的创建、读取、更新和删除
- 文件系统存储图片和音频数据

## 数据存储与使用

### 文件系统结构
```
Templates/
├── {template-uuid}/           # 模板目录
│   ├── template.json         # 模板数据文件
│   ├── cover.jpg            # 封面图片
│   ├── images/              # 时间轴图片目录
│   │   ├── {uuid}.jpg      # 时间轴图片
│   │   └── ...
│   └── records/            # 录音文件目录
│       ├── {uuid}.m4a     # 录音文件
│       └── ...
└── ...
```

### 数据结构

#### 模板数据 (template.json)
```json
{
    "metadata": {
        "id": "template-uuid",
        "createdAt": "ISO8601时间",
        "updatedAt": "ISO8601时间"
    },
    "template": {
        "title": "模板标题",
        "language": "语言",
        "coverImage": "cover.jpg",
        "totalDuration": 10.5,
        "tags": ["标签1", "标签2"],
        "timelineItems": [
            {
                "id": "uuid",
                "timestamp": 1.5,
                "script": "台词内容",
                "image": "images/uuid.jpg"
            }
        ]
    },
    "records": [
        {
            "id": "uuid",
            "createdAt": "ISO8601时间",
            "duration": 10.5,
            "audioFile": "records/uuid.m4a"
        }
    ]
}
```

### 数据管理说明

#### 模板管理
- 每个模板都有唯一的 UUID 标识
- 模板数据以 JSON 格式存储在本地文件系统
- 所有资源文件使用相对路径引用
- 支持增删改查操作

#### 图片处理
- 封面图片：固定使用 "cover.jpg" 命名
- 时间轴图片：使用 UUID 命名，存储在 images 目录
- 所有图片在保存时会进行压缩和格式化处理

#### 录音文件
- 录音使用 m4a 格式存储
- 文件使用 UUID 命名，存储在 records 目录
- 支持录音的保存、删除和回放

### 数据操作流程

#### 创建模板
1. 生成新的模板 UUID
2. 创建模板目录结构
3. 保存模板基本信息
4. 处理并保存封面图片
5. 创建必要的子目录

#### 更新模板
1. 更新模板 JSON 数据
2. 处理资源文件变更
3. 更新时间戳
4. 发送更新通知

#### 删除模板
1. 删除所有相关资源文件
2. 删除模板目录
3. 更新模板列表

#### 录音管理
1. 录音时创建临时文件
2. 录音完成后移动到模板目录
3. 更新模板数据
4. 发送更新通知

### 数据安全
- 所有文件操作都有错误处理
- 关键操作有备份机制
- 文件读写使用原子操作
- 定期清理临时文件

## 开发计划

### 即将推出的功能
- [ ] 模板分享功能
- [ ] 录音数据导出
- [ ] 更多语言支持
- [ ] 练习数据统计

### 待优化项目
- [ ] 性能优化
- [ ] 数据备份功能
- [ ] 用户偏好设置
- [ ] 多设备同步

## 贡献指南

欢迎提交 Issue 和 Pull Request 来帮助改进项目。在提交代码前，请确保：

1. 代码符合项目的编码规范
2. 添加必要的注释和文档
3. 确保所有测试通过
4. 更新相关文档

## 许可证

[待定]